---
title: "Decision Trees and Random Forests"
author: "Cameron Chong"
date: '2019-03-27'
output: pdf_document
---
```{r}
library(tree)
library(MASS)
library(randomForest)
admissionsData <- read.csv("Admission_Predict_Ver1.1.csv", header = TRUE)
#head(admissionsData)
dim(admissionsData)
trainindex <- sample(1:nrow(admissionsData), 350)
admissionsTrain <- admissionsData[trainindex, ]
admissionsTest <- admissionsData[-trainindex, ]
```
#Chance of Admittance 
I am going to do a 70/30 split of training and testing data. There are 500 observations, so we will have 350 training observations and 150 testing points. 
```{r}

set.seed(110101010)
admissionTree <- tree(Chance.of.Admit~., data = admissionsTrain)
plot(admissionTree)
text(admissionTree, pretty=0)


admissionTreeCV <- cv.tree(admissionTree, FUN = prune.tree, K = 10)
plot(admissionTreeCV, type = "b")
admissionTreeCV

```
Cross validation suggest 3 nodes would be best, so we will prune the tree using 3 terminal nodes. 

```{r}
pruneAdmissionTreeCV <- prune.tree(admissionTree, best=4)
plot(pruneAdmissionTreeCV)
text(pruneAdmissionTreeCV, pretty = 0)
summary(pruneAdmissionTreeCV)


```


```{r}

set.seed(1000101010)
admission.rf <- randomForest(Chance.of.Admit~., data = admissionsTrain, importance = TRUE)
admission.rf
```

Since Random Forest uses out-of-bag which is similar to cross validation so no cross validation was performed. We can look at the importance of the variables.


```{r}
varImpPlot(admission.rf)
```

As seen from the Importance Plot the most important variables are CGPA, GRE Score and TOEFL scores when using chance of admission as a response variable. 


#Research

```{r}
set.seed(1388582293)
researchTree <- tree(Research~., data = admissionsTrain)
plot(researchTree)
text(researchTree, pretty=0)


researchTreeCV <- cv.tree(researchTree, FUN = prune.tree, K = 10)
plot(researchTreeCV, type = "b")
researchTreeCV

```
Cross Validation suggests 2 terminal nodes would be best.

```{r}
pruneResearchTreeCV <- prune.tree(researchTree, best=4)
plot(pruneResearchTreeCV)
text(pruneResearchTreeCV, pretty = 0)
summary(pruneResearchTreeCV)
```



```{r}
set.seed(7)
research.rf <- randomForest(Research~., data = admissionsTrain, importance = TRUE)
research.rf
varImpPlot(research.rf)

```

